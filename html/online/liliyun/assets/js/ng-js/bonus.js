var app=angular.module("app",["ngFilter"]);app.controller("Bonus",["$scope","$filter",function(t,a){function e(a){var e={url:config.basePath+"bonus/query",data:{pageNo:a,pageSize:parseInt(t.pageSize)}};return e}t.defaultPage=location.hash.substring(2)||1,t.pageSize=10,t.data={pages:10,total:100,pageSize:10,pageNo:1,dataList:[{id:201,createTime:"2015-12-12 12:13",bonusName:"案例",bonusNum:5,bonusMoney:2120,status:1,creator:"admin",award:"李四",awardTime:"2015-12-12 12:13"},{id:201,createTime:"2015-12-12 12:13",bonusName:"案例",bonusNum:5,bonusMoney:2120,status:2,creator:"admin",award:"李四",awardTime:"2015-12-12 12:13"},{id:201,createTime:"2015-12-12 12:13",bonusName:"案例",bonusNum:5,bonusMoney:2120,status:3,creator:"admin",award:"李四",awardTime:"2015-12-12 12:13"}]},t.datas=t.data.dataList,t.getDataList=function(){var a=e(t.defaultPage);$.AJAX({type:"get",url:a.url,data:a.data,success:function(a){var e=getListData(a);t.total=e.total,t.datas=e.dataList,t.$apply(),new Page({parent:$("#copot-page"),nowPage:t.defaultPage,pageSize:t.pageSize,totalCount:e.total})}})},t.getDataList(),window.onhashchange=function(){win.showLoading(),t.defaultPage=location.hash.substring(2)||1,t.getDataList()},t.getDataForPage=function(){win.showLoading(),t.defaultPage=1,t.getDataList()},t.confirmSubmit=function(a,e){Layer.confirm({width:300,height:170,title:"提交后不能再更改表里的<br>内容,是否确认提交？",header:"提交"},function(){$(a.target).addClass("z-locked"),$.AJAX({url:config.basePath+"bonus/submit",data:{id:e},success:function(a){Layer.miss({width:250,height:90,title:"提交成功",closeMask:!0}),t.getDataList()}})})},t.deteleSubmit=function(a){Layer.confirm({width:300,height:160,title:"确认删除？",header:"删除"},function(){$.AJAX({url:config.basePath+"bonus/delete",data:{id:a},success:function(a){Layer.miss({width:250,height:90,title:"删除成功",closeMask:!0}),t.getDataList()}})})},t.successSubmit=function(a,e){Layer.confirm({width:300,height:170,title:"确认发放奖金到个人的<br>账户余额？",header:"发放奖金"},function(){$(a.target).addClass("z-locked"),$.AJAX({url:config.basePath+"bonus/grant",data:{id:e},success:function(a){Layer.miss({width:250,height:90,title:"发放奖金成功！",closeMask:!0}),t.getDataList()}})})},t.alertBonusDetails=function(t){if($(window).width()<=768)var a=.9*$(window).width();else var a=.6*$(window).width();Layer.iframe({header:"奖金详情",width:a,height:400,href:"bonus-details.html?id="+t})},t.createFileForm=function(){cerateFileFormData({url:config.basePath+"bonus/upload",callback:function(a){Layer.miss({width:250,height:90,title:"导入成功",closeMask:!0}),t.getDataList()}})},t.downLoadTemp=function(){window.location.href=config.basePath+"bonus/downLoadTemplate"},t.financialRejectionSubmit=function(a){Layer.confirmNotByTextAlert({header:"财务拒绝",width:400,height:260,botByText:"请填写拒绝理由",title:"您已选择财务拒绝",errmsg:"请填写拒绝的理由！"},function(e){$.AJAX({url:config.basePath+"bonus/finReject",data:{id:a,remark:e},success:function(a){Layer.miss({width:250,height:90,title:"财务拒绝成功！",closeMask:!0}),t.getDataList()}})})}}]);