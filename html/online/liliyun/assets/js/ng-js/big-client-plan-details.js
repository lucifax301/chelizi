var app=angular.module("app",["ngFilter","ngSelects"]);app.controller("RechargePriviDetail",["$scope","$rootScope","$filter","Selects",function(t,e,a,i){function n(e){var a={url:config.basePath+"vip/custom-batch",data:{pageNo:e,pageSize:parseInt(t.pageSize),vstate:t.vstate,rcid:t.rcid,isDel:0,vipBig:""}};return a.data[t.searchType]=t.search,a}t.defaultPage=location.hash.substring(2)||1,t.pageSize=10,t.rcid=getQueryString("rcid"),t.type="",t.sendPriviCnt=!1,t.sendPriviPer=!1,t.searchType="mobile",t.search="",t.vstate="",t.getRcpriviDetailsData=function(){$.AJAX({type:"get",url:config.basePath+"vip/recharge-plan",data:{rcid:t.rcid},success:function(e){t.data=JSON.parse(e.result.pageData),console.log(t.data),t.data.rechargeGearList[0].money&&(t.sendPriviCnt=!0),t.data.rechargeGearList[0].percent&&(t.sendPriviPer=!0),t.$apply()}})},t.getRcpriviDetailsData(),t.getDataList=function(){var e=n(t.defaultPage);$.AJAX({type:"get",url:e.url,data:e.data,success:function(e){var a=getListData(e);t.total=a.total,t.datas=a.dataList,console.log(t.datas),t.$apply(),new Page({parent:$("#copot-page"),nowPage:t.defaultPage,pageSize:t.pageSize,totalCount:a.total})}})},t.getDataList(),t.getDataForState=function(e,a){$(e.target).addClass("active").siblings().removeClass("active"),win.showLoading(),t.defaultPage=1,t.vstate=a,t.getDataList()},t.getDataForPage=function(){win.showLoading(),t.defaultPage=1,t.getDataList()},window.onhashchange=function(){win.showLoading(),t.defaultPage=location.hash.substring(2)||1,t.getDataList()},t.getDataForSearch=function(){win.showLoading(),t.defaultPage=1,t.getDataList()},t.delStuForPlan=function(e){Layer.confirm({width:300,height:160,title:"确认从此方案中删除吗",header:"删除关联"},function(){$.AJAX({url:config.basePath+"custom-delete",data:{studentId:e.studentId,mobile:e.mobile,rcid:e.rcid},success:function(e){Layer.miss({width:250,height:90,title:"删除成功",closeMask:!0}),t.getDataList()}})})},t.inactiveAction=function(e){var a=[];a.push(t.rcid),console.log(a),Layer.confirm({width:315,height:170,title:"确定停止发放该方案？",header:"停止发放"},function(){$.AJAX({url:config.basePath+"vip/inactive-plan",data:{ids:t.rcid},success:function(e){Layer.miss({width:250,height:90,title:"操作成功",closeMask:!0}),setTimeout(function(){window.location.href="app-client-plan-details.html?rcid="+t.rcid},1e3)}})})},t.activeAction=function(e){var a=[];a.push(t.rcid),console.log(a),Layer.confirm({width:315,height:170,title:"确定激活启用该方案？",header:"停止发放"},function(){$.AJAX({url:config.basePath+"vip/active-plan",data:{ids:t.rcid},success:function(e){Layer.miss({width:250,height:90,title:"操作成功",closeMask:!0}),setTimeout(function(){window.location.href="app-client-plan-details.html?rcid="+t.rcid},1e3)}})})},t.delItem=function(e){Layer.confirm({width:315,height:170,title:"确定激活启用该方案？",header:"停止发放"},function(){$.AJAX({url:config.basePath+"vip/custom-delete",data:{studentId:e.studentId,mobile:e.mobile,rcid:e.rcid},success:function(e){Layer.miss({width:250,height:90,title:"删除成功",closeMask:!0}),t.getDataList}})})}}]);