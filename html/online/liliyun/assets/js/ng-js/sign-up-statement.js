var app=angular.module("app",["ngFilter","ngSelects"]);app.controller("statement",["$scope","$rootScope","$filter","Selects",function(a,t,e,s){function i(t){var e={url:config.basePath+"enrollOrder/balanceQuery",data:{pageNo:t,pageSize:parseInt(a.pageSize),applyexam:a.applystateTotal.split(",")[0],applystate:a.applystateTotal.split(",")[1],schoolNo:a.schoolNo}};return e.data[a.searchType]=a.search,e}a.defaultPage=location.hash.substring(2)||1,a.pageSize=10,a.search="",a.searchType="orderId",a.schoolNo="",a.cityId="",a.cityError=!1,a.applystateTotal=",",a.statusId="",a.textRemark="",a.applyttid="",a.data={pages:10,total:100,pageSize:10,pageNo:1,dataList:[{studentId:0,name:"小张",sex:0,applyexam:4,applystate:1,phoneNum:"13476002586",applyCarType:1,coach:"张教练",idNumber:"422802198910116575",drivingSchool:"深港",accountStatus:0},{studentId:2,name:"小张",sex:1,applyexam:7,applystate:100,phoneNum:"13476002586",applyCarType:2,coach:"张教练",idNumber:"422802198910116575",drivingSchool:"深港",accountStatus:0}]},a.datas=a.data.dataList,s.selects({datas:a.datas,whichId:"orderId"}),a.getDataList=function(){var t=i(a.defaultPage);$.AJAX({type:"get",url:t.url,data:t.data,success:function(t){var e=getListData(t);a.total=e.total,a.datas=e.dataList,s.selects({datas:a.datas,whichId:"orderId"}),a.$apply(),new Page({parent:$("#copot-page"),nowPage:a.defaultPage,pageSize:a.pageSize,totalCount:e.total})}})},a.getDataList(),window.onhashchange=function(){win.showLoading(),a.defaultPage=location.hash.substring(2)||1,a.getDataList()},queryCity({callback:function(t){a.citys=t,a.$apply()}}),a.getSchools=function(){a.cityId?(a.checkHaveCity(),$("#select-school li").last().addClass("active").siblings().removeClass("active"),querySchool({cityId:a.cityId,callback:function(t){a.schools=t,a.$apply()}})):($("#select-school li").first().addClass("active").siblings().removeClass("active"),a.schoolNo="",a.schools="")},a.checkHaveCity=function(){a.cityError=!a.cityId},a.getDataForDistSchool=function(t,e){$(t.target).addClass("active").siblings().removeClass("active"),win.showLoading(),a.schoolType=e,a.defaultPage=1,a.schoolNo="",a.cityId="",a.getDataList()},a.getDataForSchool=function(){win.showLoading(),a.defaultPage=1,a.schoolType=2,a.getDataList()},a.studentStatesList=studentStatesListForLiLi,a.comSearTabCheck=function(t,e){var s="DIV"==t.target.nodeName?$(t.target):$(t.target).parent("div");$("div.tab-par").removeClass("active"),$("div.tab-chr").hide(),s.addClass("active").next("div").show(),$("div.tab-par").find("span").attr("class","ion-arrow-up-b"),s.find("span").attr("class","ion-arrow-down-b"),"all"==e&&(a.defaultPage=1,a.getDataForStudentState(t,""))},a.getDataForStudentState=function(t,e){$(t.target).addClass("active").siblings().removeClass("active"),win.showLoading(),a.applystateTotal=e,a.defaultPage=1,a.checkAllTag.applystateTotal=$(t.target).text(),a.objElement.applystateTotal=$(t.target),a.getDataList()},a.getDataForPage=function(){win.showLoading(),a.defaultPage=1,a.getDataList()},a.getDataForSearch=function(){win.showLoading(),a.defaultPage=1,a.checkAllTag.search=a.search,a.getDataList()},a.checkAllTag={},a.objElement={},a.removeTag=function(t){win.showLoading(),a.checkAllTag=deleteJson(a.checkAllTag,t),a.objElement[t]&&("LI"==a.objElement[t][0].nodeName?a.objElement[t].parent().children().eq(0).addClass("active").siblings().removeClass("active"):"children"==$(a.objElement[t][0]).attr("data-chr")&&(a.objElement[t].parent().removeClass("active"),a.objElement[t].parent().hide().children().removeClass("active"),a.objElement[t].parents("ul").find("div.tab-par").removeClass("active"),a.objElement[t].parents("ul").children().eq(0).children().addClass("active"))),a[t]="",a.getDataList()},a.removeAllTag=function(){jQuery.isEmptyObject(a.objElement)||(win.showLoading(),a.carType="",a.schoolNo="",a.applystateTotal="",clearAllActive(a.objElement),a.checkAllTag={},a.objElement={},$("div.tab-line ul").find(".tab-par").removeClass("active"),$("div.tab-line ul").find("li").eq(0).children("div").addClass("active"),$("div.tab-chr").hide().children("div").removeClass("active"),a.getDataList())},a.statement=function(){return t.idList.length?void $.AJAX({url:config.basePath+"enrollOrder/payment",data:{orderIdList:t.idList.toString()},success:function(t){Layer.miss({width:250,height:90,title:"操作成功",closeMask:!0}),a.getDataList()}}):(Layer.alert({width:300,height:150,type:"msg",title:"请选择报名订单号！",header:"结款给驾校"}),!1)}}]);