var app=angular.module("app",["ngFilter"]);app.controller("Coach",["$scope","$filter",function(t,a){function e(a){var e={url:config.basePath+"coach/batch",data:{pageNo:a,pageSize:parseInt(t.pageSize),accountStatus:t.accountStatus,studentSource:t.studentSource}};return e.data[t.searchType]=t.search,e}function i(a){var e={phoneNum:t.editData.phoneNum,sex:parseInt(t.editData.sex),idNumber:t.editData.idNumber,name:t.editData.name};return"edit"==t.editType&&angular.extend(e,{coachId:t.editData.coachId}),{url:config.basePath+a,data:e}}t.defaultPage=location.hash.substring(2)||1,t.pageSize=10,t.accountStatus=null,t.search="",t.searchType="name",t.getDataList=function(){var a=e(t.defaultPage);$.AJAX({type:"get",url:a.url,data:a.data,success:function(a){var e=getListData(a);t.total=e.total,t.datas=e.dataList,t.$apply(),new Page({parent:$("#copot-page"),nowPage:t.defaultPage,pageSize:t.pageSize,totalCount:e.total})}})},t.getDataList(),window.onhashchange=function(){win.showLoading(),t.defaultPage=location.hash.substring(2)||1,t.getDataList()},t.getDataForAccountStatus=function(a,e){$(a.target).addClass("active").siblings().removeClass("active"),win.showLoading(),t.defaultPage=1,t.accountStatus=e,t.getDataList()},t.getDataForPage=function(){win.showLoading(),t.defaultPage=1,t.getDataList()},t.getDataForSearch=function(){win.showLoading(),t.defaultPage=1,t.getDataList()},t.coachDataExport=function(){dataExportForIframe({getSearchs:e(t.defaultPage).data,total:t.total,url:"coach/export-excel"})},t.coachEditLoad=function(){$(".closeAlert").click(function(){$(this).parents("div.edit-coach").fadeOut("fast")}),$("#birthday").daterangepicker({startDate:new Date,parentElement:$("#edit-coach"),singleDatePicker:!0},function(e,i,n){t.editData.birthday=a("date")(e.toISOString(),"yyyy-MM-dd")})},t.editData={},t.editType="add",t.coachEdit=function(a,e){$(".edit-coach").fadeIn("fast"),$("#edit-coach").css("marginTop",parseInt(($(win).height()-$("#edit-coach").height()-100)/2)+"px"),console.log(e),"edit"==a?(t.editData=e,t.editType="edit"):(t.editData={},t.editType="add")},t.submitEditMsg=function(a){var e=i("add"==t.editType?"coach/add":"coach/update");return t.editData.phoneNum.length<11||!regCombination("*").test(t.editData.phoneNum)?(Layer.alert({type:"msg",height:150,title:"请填写手机正确的号码"}),!1):void $.AJAX({url:e.url,data:e.data,success:function(e){$(a.target).parents("div.edit-coach").fadeOut("fast"),Layer.miss({width:250,height:90,title:"操作成功",closeMask:!0}),t.getDataList()}})},t.closeAlert=function(){t.getDataList()}}]);