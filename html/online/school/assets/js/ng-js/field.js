var app=angular.module("app",["ngFilter"]);app.controller("Student",["$scope","$filter",function(t,e){function a(e){var a={url:config.basePath+"field/batch",data:{pageNo:e,pageSize:parseInt(t.pageSize),name:t.name,schoolName:t.schoolName}};return a}function i(e){var a={name:t.editData.name,reverseLim:parseInt(t.editData.reverseLim),phoneNum:t.editData.phoneNum,posDesc:t.editData.posDesc};return"edit"==t.editType&&angular.extend(a,{fieldId:t.editData.fieldId}),{url:config.basePath+e,data:a}}t.defaultPage=location.hash.substring(2)||1,t.pageSize=10,t.name="",t.getDataList=function(){var e=a(t.defaultPage);$.AJAX({type:"get",url:e.url,data:e.data,success:function(e){var a=getListData(e);t.total=a.total,t.datas=a.dataList,t.$apply(),new Page({parent:$("#copot-page"),nowPage:t.defaultPage,pageSize:t.pageSize,totalCount:a.total})}})},t.getDataList(),window.onhashchange=function(){win.showLoading(),t.defaultPage=location.hash.substring(2)||1,t.getDataList()},t.getDataForPage=function(){win.showLoading(),t.defaultPage=1,t.getDataList()},t.getDataForSearch=function(){win.showLoading(),t.defaultPage=1,t.getDataList()},t.getDataForSchool=function(){win.showLoading(),t.defaultPage=1,t.schoolName=t.schoolNameSelect,t.getDataList()},t.fieldDataExport=function(){dataExportForIframe({getSearchs:a(t.defaultPage).data,total:t.total,url:"field/export-excel"})},t.siteEditLoad=function(){$(".closeAlert").click(function(){$(this).parents("div.edit-alert").fadeOut("fast")})},t.editData={},t.editType="add",t.siteEdit=function(e,a){$(".edit-alert").fadeIn("fast"),$("#edit-content").css("marginTop",parseInt(($(win).height()-$("#edit-content").height()-100)/2)+"px"),"edit"==e?(t.editData=a,t.editType="edit"):(t.editData={},t.editType="add")},t.submitEditMsg=function(e){var a=i("add"==t.editType?"field/add":"field/update");return t.editData.name&&regCombination("*").test(t.editData.name)?t.editData.reverseLim&&regCombination("number").test(t.editData.reverseLim)?t.editData.phoneNum&&regCombination("phone").test(t.editData.phoneNum)?t.editData.posDesc&&regCombination("*").test(t.editData.posDesc)?void $.AJAX({url:a.url,data:a.data,success:function(a){$(e.target).parents("div.edit-alert").fadeOut("fast"),Layer.miss({width:250,height:90,title:"操作成功",closeMask:!0}),t.getDataList()}}):(Layer.alert({type:"msg",title:"请填写地理位置"}),!1):(Layer.alert({type:"msg",title:"请填写正确的联系电话"}),!1):(Layer.alert({type:"msg",title:"请填写正确的面积范围"}),!1):(Layer.alert({type:"msg",title:"请填写场地名"}),!1)},t.closeAlert=function(){t.getDataList()}}]);