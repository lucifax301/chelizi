var app=angular.module("app",["ngFilter"]);app.controller("Student",["$scope","$filter",function(a,t){function e(t){var e={url:config.basePath+"car/batch",data:{pageNo:t,pageSize:parseInt(a.pageSize),carType:a.carType,carLevel:a.carLevel,carNo:a.carNo,schoolName:a.schoolName}};return e}function i(t){var e={carNo:a.editData.carNo,carLevel:parseInt(a.editData.carLevel),driveNumber:a.editData.driveNumber,driveType:parseInt(a.editData.driveType)};return"edit"==a.editType&&angular.extend(e,{carId:a.editData.carId}),{url:config.basePath+t,data:e}}a.defaultPage=location.hash.substring(2)||1,a.pageSize=10,a.carType="",a.carLevel="",a.carNo="",a.getDataList=function(){var t=e(a.defaultPage);$.AJAX({type:"get",url:t.url,data:t.data,success:function(t){var e=getListData(t);a.total=e.total,a.datas=e.dataList,a.$apply(),new Page({parent:$("#copot-page"),nowPage:a.defaultPage,pageSize:a.pageSize,totalCount:e.total})}})},a.getDataList(),window.onhashchange=function(){win.showLoading(),a.defaultPage=location.hash.substring(2)||1,a.getDataList()},a.getDataForCarType=function(t,e){$(t.target).addClass("active").siblings().removeClass("active"),win.showLoading(),a.defaultPage=1,a.carType=e,a.getDataList()},a.getDataForAccountStatus=function(t,e){$(t.target).addClass("active").siblings().removeClass("active"),win.showLoading(),a.defaultPage=1,a.carLevel=e,a.getDataList()},a.getDataForPage=function(){win.showLoading(),a.defaultPage=1,a.getDataList()},a.getDataForSearch=function(){win.showLoading(),a.defaultPage=1,a.getDataList()},a.getDataForSchool=function(){win.showLoading(),a.defaultPage=1,a.schoolName=a.schoolNameSelect,a.getDataList()},a.carDataExport=function(){dataExportForIframe({getSearchs:e(a.defaultPage).data,total:a.total,url:"car/export-excel"})},a.carEditLoad=function(){$(".closeAlert").click(function(){$(this).parents("div.edit-alert").fadeOut("fast")})},a.editData={},a.editType="add",a.carEdit=function(t,e){$(".edit-alert").fadeIn("fast"),$("#edit-content").css("marginTop",parseInt(($(win).height()-$("#edit-content").height()-100)/2)+"px"),"edit"==t?(a.editData=e,a.editType="edit"):(a.editData={},a.editType="add")},a.submitEditMsg=function(t){var e=i("add"==a.editType?"car/add":"car/update");return a.editData.carNo&&regCombination("special").test(a.editData.carNo)?void $.AJAX({url:e.url,data:e.data,success:function(e){$(t.target).parents("div.edit-alert").fadeOut("fast"),Layer.miss({width:250,height:90,title:"操作成功",closeMask:!0}),a.getDataList()}}):(Layer.alert({type:"msg",title:"请填写车牌号"}),!1)},a.closeAlert=function(){a.getDataList()}}]);