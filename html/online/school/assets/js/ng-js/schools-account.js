var app=angular.module("app",["ngFilter"]);app.controller("accountSchool",["$scope",function(e){e.type=getQueryString("type")||0,e.schoolId=getQueryString("schoolId");var o=[],t=new Date,a=t.getFullYear(),n=("0"+(t.getMonth()+1)).slice(-2),s=("0"+(t.getDate()+1)).slice(-2);e.startTime=a+"-"+n+"-01 00:00:00",e.endTime=a+"-"+n+"-"+s+" 23:59:59",e.thismonth=n;for(var c=2015;a>=c;c++)o.push(c);$("#monthpicker").monthpicker({years:o.reverse(),onMonthSelect:function(o,t){var a=("0"+(o+1)).slice(-2),n=32-new Date(t,o,32).getDate();e.startTime=t+"-"+a+"-01 00:00:00",e.endTime=t+"-"+a+"-"+n+" 23:59:59",e.getAccountData()}}),e.getAccountData=function(){$.AJAX({type:"get",url:config.basePath+"school/queryAccount",data:{schoolId:e.schoolId,ymDate:e.startTime},success:function(o){e.schoolDetails=getListData(o),e.schoolMoneFree=JSON.parse(o.result.moneFree),e.isChange=e.schoolDetails.isChange,e.checkStatus=e.schoolDetails.checkStatus,1==e.checkStatus?window.location.href="schools-account-application.html?type=audit":3==e.checkStatus&&(window.location.href="schools-account-application.html?type=noPass"),2==e.isChange&&$(".ischangetype").attr("href","javascript:void(0);").addClass("btn-default"),""==e.schoolDetails&&(window.location.href="schools-account-application.html"),e.withdrawals=function(){2!=e.isChange&&(window.location.href="schools-account-withdrawals.html?type=0")};var t=echarts.init(document.getElementById("mainA"));optionA={series:[{type:"pie",radius:["40%","80%"],label:{normal:{show:!1,position:"center"}},data:[{value:e.schoolMoneFree.enrollFree/100,name:"课时费收益"},{value:e.schoolMoneFree.courseFree/100,name:"报名费收益"}]}]},t.setOption(optionA);var t=echarts.init(document.getElementById("mainB"));optionB={series:[{type:"pie",radius:["40%","80%"],label:{normal:{show:!1,position:"center"}},data:[{value:e.schoolMoneFree.refundFree/100,name:"退款"},{value:e.schoolMoneFree.comFree/100,name:"佣金"},{value:e.schoolMoneFree.fineFree/100,name:"罚款"}]}]},t.setOption(optionB),e.$apply()}})},e.getAccountData(),e.passClose=function(){$.AJAX({url:config.basePath+"school/closeRemark",data:{schoolId:e.schoolId},success:function(o){console.log(e.isChange),e.isChange=5,e.$apply()}})}}]);