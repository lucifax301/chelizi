var app=angular.module("app",["ngSelects"]);app.controller("UptateTel",["$scope","getMsgTime",function(e,t){t.getNowTime("setpassword"),e.schoolId=getQueryString("schoolId"),e.mobile=getQueryString("mobile"),e.captcha="",e.iscaptcha="",e.isobtainCode="",e.newtel="",e.isnewtel="",e.newcaptcha="",e.isnewcaptcha="",e.findPassword=!0,$.AJAX({type:"get",url:config.basePath+"school/queryAccount",data:{schoolId:e.schoolId},success:function(t){e.schoolDetails=JSON.parse(t.result.pageData),e.$apply()}}),e.SetPassword=function(){return regCombination("number",[5,6]).test(e.captcha)?(e.iscaptcha=0,void $.AJAX({type:"get",url:config.basePath+"authcodes/verify",data:{mobile:e.mobile,codeInput:e.captcha},success:function(t){localStorage.setItem("nowMsgTimesetpassword",""),localStorage.setItem("nowTimesetpassword",""),e.findPassword=!1,e.newTel=!0,e.$apply()},error:function(t){e.iscaptcha=t.msg,e.$apply()}})):(e.iscaptcha="请输入5-6位数字验证码",!1)},e.ObtainCode1=function(){$.AJAX({type:"get",url:config.basePath+"authcodes/one",data:{mobile:e.mobile,userType:"5",reqType:"2",timestamp:time()},success:function(o){e.isobtainCode="验证码已经发送到绑定手机号，30分钟内有效，请注意查收！",t.shotMessage("setpassword",function(){e.isobtainCode=!1})}})},e.uptateTel=function(){return regCombination("*").test(e.newtel)?regCombination("phone").test(e.newtel)?(e.isnewtel=0,regCombination("number",[5,6]).test(e.newcaptcha)?(e.isnewcaptcha=0,void $.AJAX({url:config.basePath+"school/alertMobile",data:{codeInput:e.newcaptcha,mobile:e.newtel},success:function(t){localStorage.setItem("nowMsgTimesetpassword",""),localStorage.setItem("nowTimesetpassword",""),e.newTel=!1,e.accountText=!0,e.$apply()},error:function(t){e.isnewcaptcha=t.msg,e.$apply()}})):(e.isnewcaptcha="请输入5-6位数字验证码",!1)):(e.isnewtel="手机号格式错误",!1):(e.isnewtel="请输入绑定的手机号",!1)},e.ObtainCode2=function(){return regCombination("*").test(e.newtel)?regCombination("phone").test(e.newtel)?(e.isnewtel="",void $.AJAX({type:"get",url:config.basePath+"authcodes/one",data:{mobile:e.newtel,userType:"5",reqType:"2",timestamp:time()},success:function(o){e.isobtainCodeTo="验证码已经发送到绑定手机号，30分钟内有效，请注意查收！",t.shotMessage("setpassword",function(){e.isobtainCodeTo=!1})}})):(e.isnewtel="手机号格式错误",!1):(e.isnewtel="请输入绑定的手机号",!1)}}]);